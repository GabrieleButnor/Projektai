import numpy as np
import matplotlib.pyplot as plt

 #Lagranzo daugianaris 
def Lagranzas(X, j, x):
    n = X.shape[0]
    L = np.ones(x.shape, dtype=np.double)
    for i in range(0, n):    # intervalo 2 taskai
        if (j != i):
            # esant visiems vaizudojamiems taskams, tik vieno tasko atzvilgiu
            L = L * ((x - X[i]) / (X[j] - X[i]))  
    return L


 #Lagranzo daugianario isvestine
def LagranzoIsvestine(X, j, x):
    n = X.shape[0]
    DL = np.zeros(x.shape, dtype=np.double)
    for i in range(0, n):
        if (j == i): 
            continue
        Lds = np.ones(x.shape, dtype=np.double)
        for k in range(0,n):
            if ((j != k) and (i != k)):
                Lds = Lds * (x - X[k])
        DL += Lds
    Ldv = np.ones(x.shape, dtype=np.double)
    for k in range(0, n):
        if (k != j): 
            Ldv = Ldv*(X[j] - X[k])
    DL = DL/Ldv
    return DL


# Ermito daugianaris
def Ermitas(X, j, x):
    L = Lagranzas(X, j, x)             # Lagranzo daugianaris
    DL = LagranzoIsvestine(X, j, X[j]) #Lagranzo daugianario isvestine
    U = (1 - 2 * DL * (x - X[j]))*(L**2)
    V = (x - X[j])*(L**2)
    return U, V
    

#akima formules (skaitinis diferenciavimas)
# tasko isvestines radimas. Pirmas parametras einamas taskas.
def AkimaFormule(x, ximinus1, xi, xiplius1, yi, yiminus1, yiplius1): 
    f = (2*x-xi-xiplius1) / ((ximinus1-xi)*(ximinus1-xiplius1))*yiminus1 
    f += (2*x-ximinus1-xiplius1) / ((xi-ximinus1)*(xi-xiplius1))*yi 
    f += (2*x-ximinus1-xi) / ((xiplius1-ximinus1)*(xiplius1-xi))*yiplius1
    return f

def Akima(x,y):
    n = x.shape[0]
    DY = np.zeros(x.shape, dtype=np.double) 
    for i in range(n):           # einama per visus dotuosius taskus
        if (i == 0):             # jeigu taskas pats pirmas
            ximinus1 = x[0]      # intervalo pradzia pirmas takas x
            xi = x[1]            # intervalo vidurys seknatis x
            xiplius1 = x[2]      # intervalo galas dar sekantis x
            yiminus1 = y[0]      # intervalo pradzia pirmas takas y
            yi = y[1]            # intervalo vidurys seknatis y
            yiplius1 = y[2]      # intervalo galas dar sekantis y  
            DY[i] = AkimaFormule(ximinus1, ximinus1, xi, xiplius1, yi, yiminus1, yiplius1) 
        elif (i == n-1):         # jeigu taskas pats pirmas
            ximinus1 = x[n-3] 
            xi = x[n-2]  
            xiplius1 = x[n-1] 
            yiminus1 = y[n-3]
            yi = y[n-2]
            yiplius1 = y[n-1]
            DY[n-1] = AkimaFormule(xiplius1, ximinus1, xi, xiplius1, yi, yiminus1, yiplius1)
        else:                   # jeigu viduriniai ne galu taskai
            ximinus1 = x[i-1] 
            xi = x[i] 
            xiplius1 = x[i+1] 
            yiminus1 = y[i-1]
            yi = y[i]
            yiplius1 = y[i+1] 
            DY[i] = AkimaFormule(xi, ximinus1, xi, xiplius1, yi, yiminus1, yiplius1)
    return DY

# Malio konturo koordinates 
x = np.array([-12.264,-12.247,-12.225,-12.203,-12.16,-12.139,-12.124,-12.081,-12.07,-12.062,-12.057,-12.05,-12.031,-12.011,-11.991,-11.974,-11.95,-11.936,-11.896,-11.877,-11.863,-11.855,-11.851,-11.846,-11.84,-11.837,-11.833,-11.826,-11.82,-11.82,-11.827,-11.83,-11.831,-11.826,-11.821,-11.813,-11.813,-11.811,-11.814,-11.821,-11.833,-11.839,-11.844,-11.851,-11.861,-11.859,-11.857,-11.845,-11.844,-11.847,-11.848,-11.846,-11.827,-11.821,-11.817,-11.783,-11.768,-11.755,-11.729,-11.727,-11.727,-11.702,-11.698,-11.671,-11.644,-11.615,-11.579,-11.563,-11.536,-11.524,-11.515,-11.513,-11.512,-11.513,-11.515,-11.52,-11.523,-11.526,-11.527,-11.524,-11.515,-11.458,-11.435,-11.41,-11.317,-11.298,-11.045,-11.013,-10.985,-10.948,-10.915,-10.906,-10.891,-10.882,-10.855,-10.844,-10.834,-10.827,-10.811,-10.8,-10.79,-10.782,-10.771,-10.755,-10.747,-10.739,-10.74,-10.736,-10.725,-10.709,-10.649,-10.607,-10.587,-10.585,-10.552,-10.535,-10.516,-10.5,-10.398,-10.371,-10.323,-10.309,-10.223,-10.214,-10.196,-10.188,-10.168,-10.132,-10.108,-10.068,-9.9514,-9.8356,-9.7974,-9.7407,-9.7208,-9.6721,-9.4239,-9.4359,-9.4518,-9.4517,-9.437,-9.3759,-9.3565,-9.3324,-9.3293,-9.343,-9.3492,-9.1758,-9.1414,-9.0186,-9.0032,-8.9112,-8.8434,-8.7693,-8.6893,-8.6039,-8.4702,-8.327,-8.1758,-8.0178,-7.8545,-7.6872,-7.5172,-7.3459,-7.1745,-7.0045,-6.8372,-6.6739,-6.516,-6.3647,-6.3201,-6.2216,-6.0878,-6.0108,-5.9382,-5.8703,-5.8073,-5.6732,-5.516,-5.5156,-5.5153,-5.515,-5.5147,-5.5144,-5.5141,-5.5137,-5.5134,-5.5131,-5.513,-5.5128,-5.5126,-5.5123,-5.5122,-5.5119,-5.5117,-5.5116,-5.5115,-5.5114,-5.5113,-5.5113,-5.5111,-5.511,-5.511,-5.511,-5.511,-5.511,-5.511,-5.511,-5.511,-5.511,-5.511,-5.5099,-5.509,-5.5088,-5.5081,-5.5071,-5.4884,-5.4696,-5.4508,-5.432,-5.4138,-5.3955,-5.3772,-5.3589,-5.3533,-5.3543,-5.3553,-5.3601,-5.3649,-5.405,-5.4459,-5.4854,-5.5297,-5.5665,-5.6059,-5.6146,-5.6233,-5.6277,-5.6376,-5.6476,-5.6575,-5.6673,-5.6773,-5.6872,-5.697,-5.707,-5.7169,-5.7268,-5.7367,-5.7466,-5.7565,-5.7664,-5.7764,-5.7862,-5.7964,-5.8065,-5.8168,-5.827,-5.8371,-5.8474,-5.8575,-5.8677,-5.8778,-5.888,-5.8982,-5.9084,-5.9148,-5.9212,-5.9276,-5.934,-5.9491,-5.9491,-5.9635,-5.9778,-5.9922,-6.0066,-6.0209,-6.0354,-6.0497,-6.0641,-6.0768,-6.0836,-6.0986,-6.1137,-6.1205,-6.1346,-6.1487,-6.1629,-6.177,-6.1911,-6.2052,-6.2194,-6.2335,-6.2476,-6.2617,-6.2759,-6.29,-6.3041,-6.3182,-6.3323,-6.3465,-6.3606,-6.3716,-6.3747,-6.3888,-6.4029,-6.417,-6.4312,-6.4453,-6.4594,-6.4666,-6.4826,-6.4984,-6.5057,-6.5063,-6.5159,-6.5255,-6.5352,-6.5448,-6.5545,-6.5642,-6.5738,-6.5834,-6.5931,-6.3717,-6.1502,-5.9288,-5.7073,-5.4859,-5.2645,-5.0431,-4.8216,-4.8215,-4.8214,-4.8212,-4.7449,-4.6687,-4.5924,-4.516,-4.4049,-4.3252,-4.2455,-4.1659,-4.0862,-4.0065,-3.9267,-3.847,-3.7673,-3.6876,-3.608,-3.5283,-3.4485,-3.3688,-3.2891,-3.2095,-3.1296,-3.0431,-2.9564,-2.8698,-2.7831,-2.6964,-2.6098,-2.5232,-2.4365,-2.3499,-2.2632,-2.1766,-2.0899,-2.0033,-1.9166,-1.83,-1.7433,-1.6567,-1.5701,-1.4835,-1.3968,-1.3101,-1.2235,-1.1369,-1.0502,-0.96358,-0.87692,-0.79031,-0.70365,-0.61693,-0.53032,-0.44366,-0.35703,-0.27039,-0.18373,-0.097044,-0.010408,0.0037346,0.076253,0.16297,0.2495,0.33616,0.4228,0.50946,0.59607,0.68268,0.76939,0.856,0.94261,1.0293,1.1465,1.1593,1.1779,1.1801,1.1675,1.1453,1.1446,1.1472,1.1546,1.1685,1.1913,1.2125,1.2523,1.2733,1.2967,1.3105,1.3315,1.3469,1.364,1.4072,1.4475,1.4658,1.4835,1.5204,1.5597,1.6237,1.644,1.6501,1.6492,1.6592,1.7781,1.7992,1.8209,1.8389,1.855,1.8706,1.8803,1.8838,1.8914,1.9134,1.9243,1.9412,1.9553,1.9671,1.9756,1.9834,1.9934,2.0563,2.0712,2.0975,2.1382,2.1613,2.1824,2.2008,2.2182,2.2796,2.3165,2.3482,2.3887,2.4004,2.4157,2.4399,2.4593,2.4954,2.5148,2.5257,2.6169,2.6718,2.946,3.0726,3.1305,3.147,3.1832,3.1988,3.2128,3.2168,3.1983,3.1994,3.2122,3.2175,3.2229,3.2281,3.2323,3.2317,3.2262,3.226,3.2348,3.2475,3.2582,3.2608,3.251,3.2327,3.2115,3.1929,3.1838,3.1789,3.1744,3.1527,3.1393,3.1342,3.1266,3.1118,3.1027,3.1041,3.1209,3.1388,3.1586,3.1798,3.226,3.2849,3.3084,3.3184,3.3331,3.3587,3.4397,3.4398,3.5446,3.7156,3.7903,3.8865,4.0576,4.2286,4.229,4.2294,4.2298,4.2303,4.2303,4.2307,4.2311,4.2315,4.2319,4.2322,4.2324,4.2326,4.2331,4.2334,4.2338,4.2343,4.2347,4.235,4.2353,4.2356,4.2223,4.2117,4.2037,4.1978,4.1966,4.202,4.1976,4.1846,4.182,4.1823,4.183,4.1834,4.184,4.1759,4.1617,4.1182,4.0948,4.0756,4.0606,3.9712,3.9669,3.9708,3.9832,3.984,3.9845,3.9847,3.9846,3.9848,3.9842,3.9832,3.9251,3.9099,3.9035,3.8945,3.8865,3.8738,3.8712,3.8461,3.8084,3.7289,3.6922,3.6141,3.5265,3.5165,3.5071,3.4888,3.4833,3.3804,3.1923,3.073,3.0335,3.0175,3.0103,3.0078,3.0058,3.0057,3.0002,2.9507,2.8541,2.7575,2.661,2.5642,2.4677,2.371,2.2745,2.1779,2.0814,1.9846,1.8881,1.7914,1.6949,1.5984,1.5017,1.4052,1.3315,1.2978,1.2709,1.2032,1.1231,1.0575,0.97372,0.94933,0.92214,0.76918,0.73993,0.71141,0.68381,0.67007,0.51483,0.48352,0.41879,0.38704,0.35319,0.22126,0.2132,0.21278,0.21847,-0.033197,-0.033404,-0.16699,-0.2367,-0.29918,-0.36147,-0.39767,-0.42573,-0.4356,-0.45865,-0.4679,-0.50034,-0.71972,-0.7529,-0.77127,-0.78282,-0.83625,-0.8364,-1.0431,-1.0433,-1.0786,-1.1167,-1.3077,-1.3503,-1.6969,-1.7667,-1.837,-1.9191,-1.967,-1.9971,-2.005,-2.0234,-2.0273,-2.0359,-2.085,-2.1043,-2.1198,-2.1519,-2.3856,-2.4617,-2.5161,-2.5974,-2.6198,-2.6763,-2.6932,-2.8409,-2.8673,-2.8616,-2.8586,-2.857,-2.8554,-2.8945,-2.9122,-2.9281,-2.9234,-2.8952,-2.9305,-2.965,-2.9723,-2.9793,-2.9864,-2.9948,-3.0191,-3.027,-3.0386,-3.056,-3.0675,-3.0745,-3.0773,-3.0822,-3.1,-3.1251,-3.146,-3.1679,-3.1958,-3.2404,-3.2671,-3.287,-3.2663,-3.2597,-3.2639,-3.2692,-3.284,-3.2486,-3.2624,-3.4265,-3.4485,-3.4523,-3.4406,-3.4395,-3.4495,-3.4616,-3.4739,-3.5161,-3.5385,-3.5451,-3.5539,-3.57,-3.5766,-3.5898,-3.5969,-3.6787,-3.7244,-3.7986,-3.8171,-3.8581,-3.8926,-3.9089,-3.9288,-3.9484,-3.9716,-3.984,-3.9716,-3.963,-3.9427,-3.9349,-3.9255,-3.9186,-3.918,-3.9234,-3.9475,-3.9561,-3.9593,-3.9645,-3.9655,-3.9703,-3.9741,-3.9777,-3.9813,-3.9845,-3.998,-3.9922,-3.9795,-3.9716,-3.9769,-3.9902,-4.0054,-4.016,-4.0282,-4.0435,-4.0525,-4.0793,-4.0875,-4.1043,-4.1147,-4.1316,-4.1471,-4.166,-4.1769,-4.1865,-4.1958,-4.2055,-4.2207,-4.2388,-4.2535,-4.2581,-4.2512,-4.23,-4.2278,-4.2348,-4.2462,-4.3102,-4.327,-4.3396,-4.3459,-4.3511,-4.3511,-4.3454,-4.3164,-4.2897,-4.2769,-4.2478,-4.2293,-4.2213,-4.2246,-4.2119,-4.2133,-4.2341,-4.244,-4.2455,-4.2576,-4.2763,-4.2972,-4.3109,-4.3394,-4.3689,-4.402,-4.4353,-4.4644,-4.4749,-4.4817,-4.4853,-4.4913,-4.4825,-4.4391,-4.4225,-4.4014,-4.3926,-4.3872,-4.3869,-4.3934,-4.4076,-4.4266,-4.4437,-4.4516,-4.4154,-4.4061,-4.4358,-4.4448,-4.4527,-4.4625,-4.4772,-4.4882,-4.4907,-4.4905,-4.494,-4.4923,-4.4935,-4.4974,-4.5855,-4.5605,-4.5702,-4.6003,-4.6361,-4.6467,-4.6487,-4.6527,-4.6537,-4.6736,-4.6837,-4.704,-4.7146,-4.7251,-4.7323,-4.739,-4.7469,-4.7613,-4.7895,-4.8068,-4.8262,-4.8472,-4.89,-4.9107,-4.9321,-4.9537,-4.9755,-4.9845,-4.9942,-5.0047,-5.016,-5.0343,-5.0738,-5.0893,-5.1039,-5.137,-5.1678,-5.1829,-5.2095,-5.2482,-5.2682,-5.2752,-5.2825,-5.288,-5.2934,-5.3002,-5.3065,-5.3111,-5.3148,-5.319,-5.3538,-5.3571,-5.3646,-5.3699,-5.3756,-5.3879,-5.3923,-5.4059,-5.4124,-5.4122,-5.406,-5.4004,-5.3745,-5.3706,-5.3533,-5.3447,-5.3343,-5.3148,-5.299,-5.2871,-5.2795,-5.2786,-5.2807,-5.2893,-5.2948,-5.3023,-5.3078,-5.3076,-5.3,-5.291,-5.2807,-5.2695,-5.2339,-5.2247,-5.2246,-5.2192,-5.2183,-5.2264,-5.2482,-5.2635,-5.2679,-5.2609,-5.2629,-5.2753,-5.3067,-5.3162,-5.3223,-5.3325,-5.3563,-5.373,-5.3901,-5.4898,-5.5042,-5.5073,-5.5056,-5.4956,-5.5018,-5.4791,-5.4656,-5.447,-5.4351,-5.4314,-5.4453,-5.445,-5.4465,-5.453,-5.4612,-5.468,-5.4731,-5.4826,-5.4821,-5.4772,-5.4759,-5.4606,-5.4705,-5.4774,-5.4785,-5.4711,-5.4681,-5.4817,-5.5052,-5.509,-5.5171,-5.5226,-5.5497,-5.5717,-5.5844,-5.594,-5.6218,-5.6776,-5.8063,-5.8781,-5.8933,-5.9048,-5.909,-5.9047,-5.9164,-5.963,-5.9747,-5.9783,-5.9852,-5.9971,-6.0159,-6.1053,-6.1809,-6.1943,-6.214,-6.2248,-6.24,-6.2433,-6.2407,-6.2283,-6.2259,-6.2211,-6.2144,-6.2062,-6.204,-6.2054,-6.2078,-6.2083,-6.1839,-6.1988,-6.1957,-6.1806,-6.1969,-6.2004,-6.1982,-6.1875,-6.1858,-6.1903,-6.1961,-6.2042,-6.2157,-6.2224,-6.2282,-6.2335,-6.2387,-6.2477,-6.256,-6.2613,-6.2609,-6.2562,-6.2379,-6.2314,-6.23,-6.2329,-6.2387,-6.2307,-6.2198,-6.2098,-6.2044,-6.2078,-6.2169,-6.2278,-6.2466,-6.2495,-6.2444,-6.2458,-6.256,-6.28,-6.3036,-6.3222,-6.3417,-6.3675,-6.3881,-6.4098,-6.427,-6.434,-6.4359,-6.4307,-6.4191,-6.4067,-6.3992,-6.4028,-6.4215,-6.446,-6.467,-6.5214,-6.5376,-6.5781,-6.5986,-6.6136,-6.634,-6.6471,-6.6692,-6.6679,-6.6819,-6.6842,-6.689,-6.6911,-6.6892,-6.6856,-6.6828,-6.6878,-6.6975,-6.6958,-6.6831,-6.6756,-6.6646,-6.654,-6.6478,-6.6479,-6.6531,-6.6596,-6.664,-6.6683,-6.6689,-6.6774,-6.7003,-6.7226,-6.7602,-6.7821,-6.8039,-6.8628,-6.882,-6.9387,-6.9612,-6.9731,-6.9971,-6.9949,-6.9843,-6.9712,-6.9616,-6.9594,-6.9716,-6.9924,-7.0158,-7.0405,-7.0582,-7.0731,-7.0895,-7.1064,-7.2047,-7.284,-7.347,-7.3634,-7.3718,-7.3727,-7.3663,-7.3723,-7.395,-7.4222,-7.4314,-7.4444,-7.4458,-7.4433,-7.4447,-7.4615,-7.4655,-7.4662,-7.4654,-7.4662,-7.4716,-7.4802,-7.4898,-7.5015,-7.5158,-7.5396,-7.5474,-7.5564,-7.5743,-7.5844,-7.6078,-7.6437,-7.6644,-7.67,-7.674,-7.679,-7.6879,-7.6998,-7.7086,-7.7223,-7.7223,-7.7268,-7.736,-7.724,-7.7353,-7.7574,-7.7776,-7.7644,-7.7763,-7.7783,-7.7838,-7.7912,-7.7977,-7.8013,-7.8051,-7.829,-7.8387,-7.8474,-7.8572,-7.8828,-7.8923,-7.911,-7.929,-7.9499,-7.9709,-7.9897,-7.968,-7.9626,-7.9646,-7.9712,-7.9815,-7.9963,-8.0157,-8.0701,-8.0961,-8.1155,-8.1209,-8.1221,-8.1254,-8.1354,-8.1421,-8.1506,-8.166,-8.189,-8.2106,-8.2289,-8.2539,-8.2844,-8.2955,-8.3111,-8.3156,-8.3419,-8.3398,-8.3189,-8.3118,-8.3059,-8.3036,-8.3051,-8.3111,-8.3266,-8.3473,-8.3693,-8.3813,-8.4006,-8.4105,-8.4291,-8.4382,-8.4487,-8.469,-8.4891,-8.5058,-8.5316,-8.5416,-8.5596,-8.5756,-8.5933,-8.6114,-8.6282,-8.648,-8.6652,-8.6809,-8.6962,-8.7007,-8.6969,-8.6887,-8.6798,-8.6337,-8.6231,-8.6224,-8.6249,-8.6246,-8.6154,-8.6072,-8.587,-8.5782,-8.5697,-8.5639,-8.5518,-8.5446,-8.5241,-8.5156,-8.5121,-8.5021,-8.4988,-8.497,-8.4992,-8.5023,-8.5031,-8.4926,-8.4832,-8.4446,-8.4269,-8.4067,-8.3884,-8.3767,-8.371,-8.3813,-8.3996,-8.418,-8.4261,-8.4141,-8.3934,-8.3753,-8.3976,-8.4277,-8.4881,-8.5158,-8.5276,-8.5355,-8.5394,-8.544,-8.5496,-8.5752,-8.6022,-8.6568,-8.668,-8.679,-8.6873,-8.6907,-8.7129,-8.7265,-8.7404,-8.7565,-8.7772,-8.7952,-8.8117,-8.8285,-8.8472,-8.797,-8.7978,-8.8032,-8.81,-8.8149,-8.8164,-8.8155,-8.8198,-8.838,-8.8588,-8.8816,-8.9037,-8.9221,-8.9263,-8.922,-8.907,-8.906,-8.9139,-8.927,-8.942,-8.9617,-8.9738,-8.9812,-8.9845,-8.9943,-8.9976,-8.9959,-8.9853,-8.9721,-8.9631,-8.9647,-8.9759,-8.9938,-9.0278,-9.1473,-9.1895,-9.2659,-9.2789,-9.2864,-9.2941,-9.3082,-9.3215,-9.3273,-9.3342,-9.3509,-9.3982,-9.4126,-9.4073,-9.3928,-9.3747,-9.3472,-9.3445,-9.3439,-9.3392,-9.3316,-9.3148,-9.3092,-9.3085,-9.3129,-9.3218,-9.335,-9.3319,-9.3368,-9.3602,-9.4215,-9.4389,-9.4796,-9.4959,-9.5156,-9.6282,-9.66,-9.6751,-9.6823,-9.6837,-9.6815,-9.6863,-9.6988,-9.723,-9.7786,-9.7966,-9.8068,-9.823,-9.8337,-9.8407,-9.8611,-9.8707,-9.8888,-9.9232,-9.9415,-9.9616,-9.9964,-10.016,-10.028,-10.048,-10.06,-10.07,-10.087,-10.09,-10.097,-10.105,-10.119,-10.129,-10.136,-10.16,-10.18,-10.215,-10.248,-10.254,-10.259,-10.267,-10.305,-10.311,-10.314,-10.316,-10.324,-10.326,-10.33,-10.339,-10.348,-10.354,-10.353,-10.368,-10.375,-10.381,-10.395,-10.429,-10.436,-10.446,-10.493,-10.512,-10.513,-10.504,-10.508,-10.517,-10.518,-10.515,-10.515,-10.535,-10.555,-10.567,-10.559,-10.575,-10.596,-10.614,-10.622,-10.625,-10.634,-10.645,-10.655,-10.67,-10.711,-10.74,-10.781,-10.808,-10.812,-10.811,-10.801,-10.799,-10.805,-10.823,-10.846,-10.87,-10.91,-10.928,-10.952,-10.972,-11.015,-11.039,-11.052,-11.06,-11.073,-11.084,-11.117,-11.117,-11.122,-11.136,-11.144,-11.153,-11.159,-11.166,-11.176,-11.191,-11.207,-11.223,-11.256,-11.275,-11.295,-11.315,-11.335,-11.351,-11.392,-11.41,-11.471,-11.49,-11.508,-11.492,-11.463,-11.445,-11.445,-11.451,-11.447,-11.432,-11.408,-11.389,-11.388,-11.387,-11.38,-11.378,-11.39,-11.393,-11.401,-11.402,-11.409,-11.411,-11.417,-11.425,-11.43,-11.43,-11.438,-11.449,-11.457,-11.468,-11.461,-11.44,-11.437,-11.439,-11.441,-11.442,-11.437,-11.437,-11.442,-11.45,-11.457,-11.461,-11.462,-11.456,-11.448,-11.437,-11.424,-11.41,-11.402,-11.404,-11.415,-11.415,-11.408,-11.405,-11.406,-11.408,-11.412,-11.416,-11.42,-11.421,-11.423,-11.428,-11.432,-11.433,-11.43,-11.427,-11.425,-11.429,-11.425,-11.419,-11.415,-11.417,-11.423,-11.428,-11.427,-11.421,-11.414,-11.407,-11.403,-11.394,-11.388,-11.384,-11.387,-11.389,-11.393,-11.402,-11.404,-11.412,-11.423,-11.439,-11.436,-11.434,-11.433,-11.43,-11.425,-11.423,-11.432,-11.436,-11.44,-11.445,-11.459,-11.457,-11.451,-11.45,-11.461,-11.477,-11.49,-11.502,-11.515,-11.533,-11.538,-11.539,-11.548,-11.56,-11.569,-11.572,-11.569,-11.556,-11.554,-11.559,-11.581,-11.606,-11.613,-11.613,-11.62,-11.633,-11.644,-11.647,-11.645,-11.65,-11.675,-11.695,-11.704,-11.714,-11.72,-11.727,-11.741,-11.757,-11.767,-11.773,-11.775,-11.817,-11.823,-11.828,-11.84,-11.845,-11.851,-11.855,-11.862,-11.889,-11.898,-11.9,-11.886,-11.883,-11.89,-11.898,-11.908,-11.918,-11.924,-11.933,-11.939,-11.997,-12.015,-12.037,-12.05,-12.07,-12.084,-12.098,-12.012,-11.979,-11.963,-11.957,-11.957,-11.963,-11.98,-11.999,-12.015,-12.025,-12.025,-12.003,-11.995,-11.998,-12.034,-12.044,-12.058,-12.098,-12.11,-12.12,-12.128,-12.113,-12.109,-12.116,-12.209,-12.222,-12.22,-12.222,-12.234,-12.236,-12.23,-12.211,-12.204,-12.201,-12.2,-12.198,-12.191,-12.172,-12.166,-12.165,-12.173,-12.183,-12.19,-12.192,-12.19,-12.186,-12.18,-12.191,-12.208,-12.223,-12.23,-12.237,-12.257,-12.264])
y = np.array([14.775,14.767,14.763,14.766,14.781,14.785,14.777,14.74,14.734,14.746,14.762,14.767,14.763,14.763,14.768,14.78,14.812,14.824,14.832,14.842,14.854,14.867,14.876,14.883,14.888,14.893,14.895,14.897,14.9,14.906,14.916,14.92,14.926,14.962,14.98,14.996,14.996,15.014,15.029,15.04,15.049,15.049,15.044,15.042,15.049,15.054,15.084,15.125,15.135,15.149,15.158,15.179,15.233,15.28,15.296,15.366,15.437,15.469,15.496,15.507,15.541,15.537,15.537,15.528,15.526,15.541,15.578,15.587,15.595,15.6,15.61,15.615,15.62,15.625,15.63,15.633,15.635,15.638,15.643,15.643,15.644,15.633,15.623,15.602,15.472,15.451,15.27,15.24,15.187,15.152,15.103,15.12,15.177,15.193,15.218,15.235,15.271,15.288,15.303,15.307,15.307,15.308,15.325,15.334,15.341,15.362,15.404,15.423,15.433,15.434,15.425,15.424,15.427,15.428,15.439,15.442,15.438,15.44,15.439,15.434,15.437,15.435,15.402,15.402,15.405,15.405,15.395,15.373,15.366,15.365,15.381,15.371,15.38,15.413,15.421,15.431,15.441,15.496,15.559,15.588,15.615,15.686,15.698,15.688,15.655,15.587,15.496,15.496,15.496,15.496,15.496,15.495,15.495,15.495,15.495,15.495,15.495,15.495,15.495,15.495,15.495,15.495,15.495,15.495,15.495,15.495,15.495,15.495,15.495,15.495,15.495,15.495,15.494,15.494,15.494,15.494,15.494,15.494,15.494,15.494,15.494,15.494,15.494,15.494,15.494,15.494,15.493,15.493,15.493,15.493,15.493,15.493,15.493,15.493,15.493,15.494,15.494,15.494,15.494,15.494,15.494,15.494,15.494,15.495,15.495,15.495,15.495,15.495,15.495,15.496,15.496,15.501,15.506,15.507,15.511,15.516,15.613,15.71,15.807,15.904,15.999,16.093,16.188,16.282,16.312,16.318,16.325,16.33,16.335,16.362,16.389,16.415,16.445,16.469,16.496,16.512,16.528,16.568,16.658,16.749,16.839,16.929,17.019,17.109,17.2,17.29,17.38,17.47,17.561,17.651,17.741,17.831,17.921,18.012,18.104,18.197,18.29,18.383,18.475,18.568,18.661,18.754,18.846,18.939,19.032,19.125,19.183,19.241,19.3,19.358,19.495,19.496,19.621,19.746,19.871,19.996,20.121,20.245,20.37,20.495,20.603,20.662,20.791,20.92,20.978,21.099,21.22,21.34,21.461,21.582,21.702,21.823,21.944,22.064,22.185,22.306,22.426,22.547,22.668,22.788,22.909,23.03,23.124,23.15,23.271,23.392,23.512,23.633,23.754,23.874,23.936,24.072,24.208,24.27,24.276,24.357,24.437,24.516,24.596,24.676,24.755,24.835,24.914,24.994,24.994,24.994,24.994,24.995,24.995,24.995,24.995,24.995,24.995,24.995,24.995,24.947,24.899,24.852,24.804,24.731,24.679,24.627,24.575,24.523,24.471,24.419,24.367,24.314,24.262,24.21,24.158,24.106,24.054,24.002,23.95,23.898,23.841,23.784,23.728,23.671,23.614,23.558,23.501,23.444,23.388,23.331,23.274,23.218,23.161,23.104,23.048,22.991,22.935,22.878,22.821,22.765,22.708,22.651,22.595,22.538,22.481,22.425,22.368,22.311,22.255,22.198,22.141,22.085,22.028,21.971,21.915,21.858,21.849,21.801,21.745,21.688,21.632,21.575,21.518,21.462,21.405,21.348,21.292,21.235,21.178,21.102,21.082,21.017,20.995,20.886,20.796,20.776,20.751,20.739,20.733,20.731,20.731,20.739,20.739,20.733,20.723,20.688,20.669,20.658,20.645,20.639,20.634,20.623,20.617,20.598,20.551,20.523,20.487,20.412,20.398,20.304,20.295,20.294,20.296,20.295,20.284,20.263,20.244,20.232,20.231,20.236,20.251,20.255,20.253,20.248,20.242,20.236,20.215,20.213,20.224,20.261,20.275,20.279,20.274,20.264,20.218,20.18,20.138,20.067,20.057,20.051,20.046,20.039,20.02,20.016,20.015,19.998,19.996,19.942,19.889,19.845,19.838,19.828,19.821,19.808,19.794,19.592,19.554,19.517,19.511,19.508,19.504,19.495,19.489,19.469,19.46,19.441,19.426,19.41,19.388,19.365,19.352,19.341,19.326,19.308,19.269,19.252,19.23,19.222,19.213,19.193,19.171,19.154,19.136,19.113,19.096,19.082,19.07,19.051,18.996,18.982,18.978,18.976,18.977,18.996,18.996,19.015,19.047,19.061,19.079,19.11,19.142,19.019,18.895,18.771,18.648,18.645,18.524,18.4,18.277,18.153,18.029,17.975,17.906,17.782,17.658,17.535,17.411,17.288,17.164,17.101,16.996,16.987,16.986,16.983,16.965,16.947,16.849,16.839,16.819,16.81,16.746,16.613,16.527,16.416,16.393,16.38,16.358,16.341,16.321,16.298,16.086,16.059,16.031,16.001,16,15.999,15.997,15.996,15.99,15.987,15.984,15.928,15.905,15.886,15.789,15.75,15.721,15.715,15.685,15.666,15.651,15.631,15.548,15.496,15.469,15.354,15.358,15.359,15.376,15.408,15.427,15.426,15.423,15.418,15.408,15.389,15.352,15.339,15.337,15.334,15.331,15.328,15.325,15.321,15.318,15.315,15.312,15.309,15.305,15.302,15.299,15.296,15.293,15.289,15.286,15.284,15.276,15.26,15.199,15.126,15.067,14.991,14.98,14.974,14.969,14.958,14.947,14.941,14.94,14.994,14.992,14.97,14.963,14.963,14.996,14.985,14.961,14.911,14.996,14.996,15.05,15.066,15.055,15.018,15.002,15.003,15.015,15.075,15.08,15.08,15.078,15.07,15.057,15.048,14.996,14.996,14.818,14.818,14.796,14.78,14.735,14.715,14.496,14.483,14.48,14.486,14.484,14.471,14.444,14.199,14.188,14.181,14.16,14.151,14.149,14.156,14.265,14.281,14.268,14.222,14.204,14.142,14.123,14.043,14.001,14.002,14,13.998,13.996,13.867,13.838,13.8,13.746,13.652,13.639,13.626,13.624,13.628,13.632,13.635,13.638,13.635,13.63,13.611,13.607,13.622,13.637,13.646,13.663,13.677,13.677,13.672,13.675,13.708,13.717,13.698,13.682,13.658,13.603,13.579,13.542,13.293,13.284,13.274,13.266,13.238,13.203,13.185,13.169,13.166,13.168,13.174,13.173,13.174,13.18,13.197,13.199,13.197,13.199,13.262,13.289,13.347,13.355,13.366,13.379,13.382,13.38,13.381,13.387,13.396,13.408,13.413,13.432,13.435,13.436,13.44,13.451,13.454,13.458,13.462,13.468,13.488,13.489,13.496,13.499,13.5,13.499,13.496,13.481,13.476,13.475,13.47,13.461,13.449,13.44,13.436,13.432,13.414,13.409,13.402,13.398,13.383,13.365,13.324,13.3,13.278,13.272,13.273,13.275,13.273,13.263,13.247,13.229,13.214,13.205,13.193,13.184,13.176,13.172,13.176,13.169,13.135,13.127,13.118,13.106,13.097,13.071,13.013,12.996,12.972,12.949,12.921,12.865,12.819,12.807,12.742,12.73,12.729,12.721,12.715,12.712,12.716,12.733,12.739,12.737,12.728,12.717,12.716,12.717,12.715,12.663,12.646,12.613,12.597,12.55,12.537,12.534,12.53,12.516,12.498,12.48,12.459,12.435,12.35,12.307,12.302,12.309,12.32,12.328,12.327,12.321,12.314,12.306,12.29,12.279,12.273,12.269,12.197,12.149,12.139,12.138,12.118,12.098,12.082,12.072,12.069,12.06,12.059,12.061,12.059,12.05,12.037,12.025,12.015,12.007,12.002,11.996,12.013,12.013,11.998,11.998,12.003,12.005,11.996,11.989,11.983,11.981,11.981,11.979,11.981,11.979,11.973,11.953,11.944,11.931,11.901,11.87,11.843,11.837,11.836,11.839,11.843,11.846,11.846,11.843,11.839,11.837,11.832,11.83,11.822,11.82,11.822,11.831,11.832,11.83,11.829,11.824,11.812,11.81,11.795,11.791,11.795,11.794,11.791,11.782,11.773,11.759,11.739,11.721,11.699,11.66,11.65,11.64,11.629,11.618,11.606,11.604,11.606,11.604,11.576,11.541,11.458,11.435,11.422,11.413,11.403,11.39,11.372,11.268,11.252,11.231,11.199,11.176,11.136,11.122,11.107,11.1,11.095,11.082,11.073,11.057,11.048,10.996,10.97,10.976,10.948,10.878,10.857,10.845,10.787,10.779,10.769,10.764,10.76,10.753,10.738,10.684,10.675,10.659,10.65,10.645,10.636,10.62,10.604,10.597,10.588,10.535,10.499,10.491,10.44,10.425,10.436,10.45,10.454,10.454,10.447,10.442,10.413,10.376,10.365,10.348,10.33,10.275,10.267,10.283,10.274,10.249,10.227,10.208,10.19,10.189,10.216,10.224,10.248,10.255,10.252,10.289,10.303,10.316,10.314,10.31,10.308,10.311,10.316,10.323,10.329,10.332,10.359,10.371,10.389,10.42,10.439,10.449,10.457,10.475,10.481,10.491,10.495,10.494,10.493,10.495,10.501,10.508,10.513,10.514,10.512,10.514,10.529,10.537,10.552,10.56,10.572,10.584,10.598,10.607,10.612,10.618,10.63,10.638,10.645,10.651,10.658,10.666,10.707,10.721,10.726,10.723,10.713,10.7,10.691,10.692,10.696,10.694,10.686,10.668,10.629,10.615,10.608,10.602,10.592,10.569,10.557,10.552,10.554,10.564,10.57,10.591,10.605,10.618,10.653,10.661,10.654,10.651,10.627,10.627,10.608,10.589,10.581,10.574,10.566,10.52,10.488,10.471,10.452,10.448,10.445,10.44,10.433,10.422,10.413,10.405,10.398,10.366,10.361,10.349,10.342,10.344,10.366,10.373,10.371,10.344,10.341,10.348,10.345,10.332,10.253,10.239,10.23,10.222,10.211,10.186,10.164,10.149,10.141,10.14,10.156,10.179,10.198,10.207,10.234,10.247,10.248,10.252,10.265,10.289,10.329,10.345,10.346,10.336,10.334,10.334,10.34,10.35,10.361,10.389,10.399,10.407,10.418,10.429,10.441,10.45,10.456,10.459,10.458,10.428,10.421,10.417,10.418,10.417,10.419,10.44,10.437,10.429,10.416,10.406,10.403,10.405,10.402,10.391,10.384,10.383,10.378,10.364,10.347,10.334,10.33,10.313,10.293,10.278,10.27,10.266,10.26,10.249,10.242,10.212,10.204,10.198,10.194,10.191,10.185,10.169,10.161,10.155,10.155,10.162,10.21,10.233,10.259,10.282,10.307,10.328,10.339,10.342,10.347,10.36,10.373,10.399,10.412,10.427,10.43,10.425,10.418,10.414,10.414,10.423,10.47,10.511,10.537,10.735,10.753,10.763,10.784,10.84,10.847,10.856,10.875,10.978,11.001,11.024,11.043,11.054,11.054,11.043,11.042,11.048,11.05,11.047,11.046,11.053,11.053,10.999,10.984,10.972,10.967,10.965,10.965,10.968,10.966,10.957,10.952,10.963,10.978,10.996,11.013,11.025,11.071,11.091,11.103,11.112,11.122,11.134,11.137,11.137,11.142,11.158,11.193,11.211,11.215,11.224,11.229,11.23,11.231,11.234,11.241,11.247,11.252,11.255,11.278,11.285,11.276,11.274,11.275,11.281,11.295,11.321,11.325,11.322,11.326,11.34,11.353,11.363,11.368,11.386,11.4,11.418,11.419,11.423,11.438,11.456,11.478,11.49,11.47,11.472,11.496,11.511,11.53,11.55,11.568,11.64,11.649,11.646,11.639,11.636,11.642,11.652,11.659,11.658,11.913,11.925,11.935,11.944,11.955,11.977,11.996,12.013,12.028,12.032,12.029,12.03,12.045,12.064,12.086,12.125,12.148,12.17,12.187,12.196,12.188,12.188,12.199,12.209,12.225,12.235,12.261,12.282,12.302,12.324,12.346,12.369,12.388,12.405,12.465,12.479,12.495,12.494,12.488,12.484,12.489,12.497,12.498,12.496,12.485,12.473,12.455,12.445,12.428,12.411,12.396,12.389,12.38,12.371,12.366,12.363,12.358,12.345,12.326,12.31,12.307,12.283,12.27,12.247,12.257,12.255,12.236,12.225,12.207,12.17,12.15,12.134,12.119,12.101,12.081,12.068,12.051,12.025,12.027,12.032,12.038,12.051,12.055,12.055,12.052,12.052,12.061,12.088,12.093,12.096,12.114,12.12,12.126,12.141,12.148,12.15,12.151,12.152,12.154,12.159,12.17,12.175,12.175,12.175,12.178,12.195,12.201,12.207,12.214,12.218,12.203,12.191,12.191,12.197,12.202,12.2,12.19,12.185,12.185,12.181,12.166,12.172,12.175,12.18,12.172,12.143,12.135,12.121,12.124,12.118,12.108,12.088,12.085,12.08,12.071,12.06,12.053,12.039,12.029,12.017,11.995,11.99,11.98,11.968,11.958,11.944,11.925,11.908,11.899,11.892,11.89,11.92,11.996,12.023,12.033,12.042,12.059,12.068,12.096,12.11,12.121,12.138,12.2,12.213,12.219,12.219,12.204,12.205,12.203,12.192,12.149,12.137,12.114,12.113,12.107,12.085,12.081,12.081,12.078,12.049,12.029,12.014,12.01,12.009,11.996,11.996,12.003,12.013,12.026,12.04,12.094,12.108,12.135,12.151,12.192,12.221,12.25,12.289,12.313,12.352,12.375,12.383,12.382,12.384,12.404,12.43,12.457,12.48,12.498,12.492,12.48,12.489,12.505,12.513,12.529,12.526,12.516,12.508,12.515,12.535,12.54,12.544,12.55,12.559,12.571,12.578,12.585,12.596,12.627,12.637,12.648,12.653,12.656,12.658,12.673,12.681,12.686,12.712,12.716,12.719,12.732,12.741,12.76,12.764,12.771,12.782,12.794,12.804,12.813,12.82,12.825,12.826,12.826,12.827,12.829,12.836,12.841,12.845,12.85,12.866,12.876,12.887,12.897,12.902,12.907,12.912,12.919,12.922,12.92,12.916,12.916,12.923,12.927,12.933,12.959,12.971,12.981,12.989,12.972,12.961,12.956,12.959,12.969,12.988,12.997,13.001,13.005,13.009,13.013,13.017,13.023,13.035,13.055,13.06,13.068,13.075,13.079,13.083,13.091,13.1,13.108,13.112,13.128,13.163,13.176,13.187,13.199,13.217,13.228,13.246,13.257,13.267,13.286,13.32,13.339,13.361,13.358,13.354,13.356,13.366,13.38,13.384,13.383,13.379,13.38,13.388,13.398,13.406,13.408,13.4,13.383,13.363,13.343,13.312,13.307,13.307,13.317,13.324,13.343,13.351,13.356,13.369,13.371,13.382,13.436,13.454,13.465,13.469,13.47,13.475,13.481,13.496,13.503,13.544,13.564,13.598,13.634,13.673,13.693,13.704,13.751,13.785,13.829,13.87,13.89,13.909,13.93,13.944,13.959,13.985,14.027,14.103,14.144,14.166,14.25,14.265,14.274,14.288,14.298,14.311,14.324,14.33,14.342,14.355,14.389,14.391,14.435,14.455,14.499,14.519,14.537,14.548,14.554,14.565,14.577,14.588,14.598,14.616,14.625,14.642,14.648,14.65,14.656,14.667,14.674,14.681,14.693,14.693,14.697,14.703,14.715,14.728,14.746,14.775])


# interpoliavimo tasku skaicius
#n = 10
#n = 20 
#n = 50 
n = 100
viso = x.shape[0]       # konturo tasku visas kiekis
stepPoz = (viso / n)    # kas kalinta taska paiimti 
stepPoz = int(stepPoz)  

X = []
Y = []
# imame kas kelinta pozicija tasko reiksme, kad gautume
# n interpoliavimo tasku, bet reiksmes gautume pasiskirsciusias visame konture
for i in range(0,viso,stepPoz):
    if (len(X) != n):
        X.append(x[i])
        Y.append(y[i])


# uzdaro konturo sudarymas
xg = X[0]
yg = Y[0]
X = np.append(X, xg)
Y = np.append(Y, yg)
n = n + 1

print("Išsirinkti X : ");print(X)
print("Išsirinkti Y : ");print(Y)

# atvaizdavimas mazgu
plt.axis([-20,15,5,30])
plt.title("Malis.")
plt.scatter(X, Y, color = "red", marker="o", label = "Taskai (mazgai)")

# pozicinio parametro nustatymas
# kad islaikytume koturo tasku seka
t = np.arange(0, n, 1)
# randame tasku isvestines
DYt = Akima(t, Y)       # y isvestine pagal t (pozicija)
DXt = Akima(t, X)       # x isvestine pagal t (pozicija)


# interpoliavimas Ermito splainai (parametrinis)
#----------------------------------------------------------------
p = len(t)                      # poziciju (tasku) kiekis
for i in range(0, p-1):         # einame per visus taskus
    m = 100                     # atvaizudojamu tasku sk
    # atvaziudojamu tasku koordinates poziciju interavale
    xatv = np.arange(t[i], t[i + 1], 0.01)  
    fy = np.zeros(xatv.shape, dtype=np.double)
    fx = np.zeros(xatv.shape, dtype=np.double)
    for j in range(0,2):
         # skaicuojam Ermito daugianariu kiekvienam intervalo galui atskirai
        U,V = Ermitas(t[i:i+2], j, xatv)       
        fx = fx + U * X[i+j] + V * DXt[i+j]     # kreives x reiksmes islaikant pozicija
        fy = fy + U * Y[i+j] + V * DYt[i+j]     # kreives y reiksmes islaikant pozicija
    plt.plot(fx, fy, color = "blue")            # interpoliacine kreive tasku poziciju intervale


plt.grid(1)
plt.legend()
plt.show()